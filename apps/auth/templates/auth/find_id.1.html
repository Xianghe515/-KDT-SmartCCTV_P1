{% extends "server/base.html" %}
{% block title %}아이디 찾기{% endblock %}
{% block content %}
<div class="relative flex h-[600px] bg-gray-100">

<div class="absolute inset-0 flex items-center justify-end pr-24">
      <div class="w-96 p-8 bg-white rounded-lg shadow-lg">
          <h2 class="text-2xl font-bold mb-6 text-center">아이디 찾기</h2>
          <form class="space-y-4" action="{{ url_for('auth.find_id') }}" method="post" novalidate>
              {{ form_find_id.csrf_token }}
              <div class="form-floating">
                  <input type="text" class="form-control dt-auth-input {% if form_find_id.user_name.errors %}is-invalid{% endif %} w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-custom focus:border-custom"   placeholder="" id="findIdUserName" name="user_name" placeholder="" required>
                  <label for="findIdUserName" class="form-label">이름</label>
                  {% if form_find_id.user_name.errors %}
                  <div class="invalid-feedback">{{ form_find_id.user_name.errors[0] }}</div>
                  {% elif form_find_id.user_name.data %}
                  <div class="valid-feedback"></div>
                  {% endif %}
              </div>
              <div class="form-floating">
                  <input type="text" class="form-control dt-auth-input {% if form_find_id.phone_number.errors %}is-invalid{% endif %} w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-custom focus:border-custom"   placeholder="" id="findIdPhoneNumber" name="phone_number" required>
                  <label for="findIdPhoneNumber" class="form-label">전화번호</label>
                  {% if form_find_id.phone_number.errors %}
                  <div class="invalid-feedback">{{ form_find_id.phone_number.errors[0] }}</div>
                  {% elif form_find_id.phone_number.data %}
                  <div class="valid-feedback"></div>
                  {% endif %}
              </div>
              <div class="flex justify-end">
                  <button type="submit" class="btn dt-auth-btn bg-[#0D1B2A] text-white py-2 rounded-md hover:bg-sky-700 transition-colors">아이디 찾기</button>
              </div>
          </form>
  
          {# 결과 표시 영역 #}
          {% if masked_email %}
          <div class="alert alert-success mt-3" role="alert">
              회원님의 이메일 주소는 <strong>{{ masked_email }}</strong> 입니다.
          </div>
          {% elif not_found %}
          <div class="alert alert-danger mt-3" role="alert">
              입력하신 정보와 일치하는 사용자를 찾을 수 없습니다.
          </div>
          {% endif %}
      </div>
  </div>
</div>

<script>
      function formatPhoneNumber(input) {
          let value = input.value.replace(/\D/g, ''); // 숫자가 아닌 문자 제거
          let formattedValue = '';
          if (value.length > 0) {
              formattedValue += value.substring(0, 3);
              if (value.length > 3) {
                  formattedValue += '-' + value.substring(3, 7);
              }
              if (value.length > 7) {
                  formattedValue += '-' + value.substring(7, 11);
              }
          }
          input.value = formattedValue;
      }
  
      document.addEventListener('DOMContentLoaded', function () {
          const findIdPhoneNumberInput = document.getElementById("findIdPhoneNumber");
          if (findIdPhoneNumberInput) {
              findIdPhoneNumberInput.addEventListener("input", function () {
                  formatPhoneNumber(this);
              });
          }
      });
</script>

{% endblock %}